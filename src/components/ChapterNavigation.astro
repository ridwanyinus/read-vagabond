---
export interface Props {
  volume: number;
  chapter: {
    number: number;
    title: string;
    pageCount: number;
  };
  prevChapter: number | null;
  nextChapter: number | null;
}

const { volume, chapter, prevChapter, nextChapter } = Astro.props;
---

<nav
  class="fixed top-0 left-0 right-0 bg-white/80 backdrop-blur-md border-b border-gray-200/50 z-50 transition-transform duration-300"
  id="navBar"
>
  <div
    class="max-w-7xl flex flex-wrap items-center justify-center md:justify-between mx-auto p-4"
  >
    <div class="flex items-center gap-3 md:gap-4">
      <a href="/">
        <img src="/Vagabond_Logo.png" alt="Vagabond" class="h-15" />
      </a>

      <div class="flex flex-col gap-0.5">
        <span
          class="bg-gray-100 text-gray-800 text-2xs md:text-xs font-medium px-2 py-0.5 rounded uppercase tracking-wide"
        >
          Ch. {chapter.number}
        </span>
        <span class="text-xs md:text-sm font-semibold text-gray-900">
          {chapter.title}
        </span>
      </div>
    </div>

    <div class="flex items-center gap-2 md:gap-3">
      <span
        class="text-gray-500 text-[11px] md:text-sm font-medium whitespace-nowrap uppercase"
      >
        Pg. <span id="pageCounter">1</span> / {chapter.pageCount}
      </span>
      {
        prevChapter !== null ? (
          <a
            href={`/volume-${volume}/chapter-${prevChapter}`}
            class="text-gray-900 bg-white border border-gray-300 hover:bg-gray-100 focus:ring-4 focus:ring-gray-100 font-medium rounded-lg text-[11px] md:text-sm px-3 py-1.5 md:px-4 md:py-2 focus:outline-none transition-colors whitespace-nowrap"
          >
            <span class="inline-flex items-center gap-1">
              <svg
                class="w-3 h-3"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M15 19l-7-7 7-7"
                />
              </svg>
              Prev
            </span>
          </a>
        ) : (
          <button
            class="text-gray-400 bg-gray-100 border border-gray-200 font-medium rounded-lg text-[11px] md:text-sm px-3 py-1.5 md:px-4 md:py-2 cursor-not-allowed whitespace-nowrap"
            disabled
          >
            <span class="inline-flex items-center gap-1">
              <svg
                class="w-3 h-3"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M15 19l-7-7 7-7"
                />
              </svg>
              Prev
            </span>
          </button>
        )
      }
      {
        nextChapter !== null ? (
          <a
            href={`/volume-${volume}/chapter-${nextChapter}`}
            class="text-white bg-gray-900 hover:bg-gray-800 focus:ring-4 focus:ring-gray-300 font-medium rounded-lg text-[11px] md:text-sm px-3 py-1.5 md:px-4 md:py-2 focus:outline-none transition-colors whitespace-nowrap"
          >
            <span class="inline-flex items-center gap-1">
              Next
              <svg
                class="w-3 h-3"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M9 5l7 7-7 7"
                />
              </svg>
            </span>
          </a>
        ) : (
          <button
            class="text-gray-400 bg-gray-100 border border-gray-200 font-medium rounded-lg text-[11px] md:text-sm px-3 py-1.5 md:px-4 md:py-2 cursor-not-allowed whitespace-nowrap"
            disabled
          >
            <span class="inline-flex items-center gap-1">
              Next
              <svg
                class="w-3 h-3"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M9 5l7 7-7 7"
                />
              </svg>
            </span>
          </button>
        )
      }
    </div>
  </div>
</nav>

<script>
  import { currentPage, navbarVisibility } from "../feature/reader/store";

  const navBar = document.getElementById("navBar") as HTMLElement;
  const pageCounter = document.getElementById("pageCounter") as HTMLElement;

  currentPage.subscribe((page) => {
    pageCounter.textContent = `${page + 1}`;
  });

  navbarVisibility.subscribe((visibility) => {
    if (visibility === "visible") {
      navBar.classList.remove("-translate-y-full");
    } else {
      navBar.classList.add("-translate-y-full");
    }
  });
</script>
